# Въведение в С

## 1. Азбука

**а/** букви - малки и главни латински букви и знак за подчертаване

**б/** цифри - от 0 до 9

**в/** специални символи: `+` `-` `*` `/` `%` `!` `?` `&` `|` `>` `<` `=` `(` `)` `[` `]` `{` `}` `.` `,` `;` `:` `#` `'` `"` и др.

## 2. Лексика

**Лексема (дума)** - най-малката единица на езика, която има определен смисъл

### Видове лексеми (tokens):

**а/** **служебни (ключови, резервирани, запазени) думи** - имат точно предназначение в езика и не могат да се използват за други цели (напр. не може да кръстиш променливата си `while`).

Пишат се с малки букви.

**Примери:** `if`, `else`, `while`, `do`, `for`, `switch`, `case`, `break`, `continue` и др.

**б/** **идентификатори (имена)** - служат за обозначаване на променливи, функции и др.

Идентификаторът започва с буква (виж т.1а), а всеки следващ символ е буква или цифра.

Има разлика между малки и главни букви - `Max` е различно от `max`.

Не могат да се използват ключови думи за идентификатори.

**в/** **операции** - някои се състоят от един служебен символ, а други от два.

**Примери:** събиране (`+`), изваждане (`-`) и т.н. `>=`, `<=`, `==`, `!=`

**г/** **константи**

**Примери:** `245`, `2.5`, `-10.12`

**д/** **разделители**

**Например:** `.` `,` `;` `:` `(` `)` `{` `}` `[` `]` и др.

Програмата е съставена от лексеми. Между всеки две лексеми трябва да има един или повече празни символи. Празни символи са интервал, табулация, нов ред. Изключение за празните символи между лексемите е ако едната от лексемите е разделител или знак за операция (тогава не е задължително да има празен символ между тях).

### Терминология:

- **`;` (точка и запетая)** - разделител, който завършва всеки оператор в C
- **`{ }` (фигурни скоби)** - обозначават началото и края на блок от код (тяло на функция, съставен оператор)
- **`()` (кръгли скоби)** - използват се за параметри на функции и за групиране на изрази
- **`//` (двойна наклонена черта)** - начало на коментар на един ред. Всичко след `//` до края на реда се игнорира от компилатора

## 3. Синтаксис

**Структура на програма** - състои се от една или повече функции. Има точно една главна функция - `main()`, от която започва изпълнението на програмата.

### Дефиниция на функция:

Състои се от **заглавие** и **тяло**.

**Заглавието** се състои от:
- тип на връщаната от функцията стойност (напр. `int`, `float`, `void`)
- име на функцията (валиден за езика идентификатор)
- списък от параметри заградени в кръгли скоби (кръглите скоби са задължителни, дори да няма параметри)

### Терминология:

- **`void`** - празен тип, означава че функцията не връща стойност
- **`int`** - целочислен тип данни, означава че функцията връща цяло число
- **`main()`** - главна функция, от която започва изпълнението на програмата. Всяка C програма трябва да има точно една функция `main()`

**Тялото** се състои от отварящи фигурни скоби, един или повече оператори, затварящи фигурни скоби.

Всеки оператор в С завършва с `;`

### Пример 1:

```c
#include <stdio.h>    // препроцесорна директива - включва стандартната библиотека за вход/изход (виж [Препроцесор](#4-препроцесор-и-етапи-на-компилация))
void main()           // void - тип (не връща стойност) (виж [Синтаксис](#3-синтаксис)), main - име на функция (виж [Синтаксис](#3-синтаксис)), () - кръгли скоби (без параметри)
{                     // { - начало на съставния оператор (тяло на функцията) (виж [Съставен оператор](../03_Оператори.md#3-съставен-оператор))
    printf("Hello");  // printf - функция за изход от #include <stdio.h> (виж [Въвеждане и извеждане](../02_Целочислени%20типове%20данни.md#5-въвеждане-и-извеждане-на-данни-от-целочислен-тип)), ; - край на оператора
    return;           // return - оператор за връщане (виж [Синтаксис](#3-синтаксис)), ; - край на оператора (не е задължително при void)
}                     // } - край на съставния оператор (виж [Съставен оператор](../03_Оператори.md#3-съставен-оператор))
```

### Пример 2:

```c
#include <stdio.h>    // препроцесорна директива - включва стандартната библиотека за вход/изход (виж [Препроцесор](#4-препроцесор-и-етапи-на-компилация))
int main()            // int - тип на връщаната стойност (виж [Синтаксис](#3-синтаксис)), main - име на функция (виж [Синтаксис](#3-синтаксис)), () - кръгли скоби (без параметри)
{                     // { - начало на съставния оператор (тяло на функцията) (виж [Съставен оператор](../03_Оператори.md#3-съставен-оператор))
    printf("Hello");  // printf - функция за изход от #include <stdio.h> (виж [Въвеждане и извеждане](../02_Целочислени%20типове%20данни.md#5-въвеждане-и-извеждане-на-данни-от-целочислен-тип)), ; - край на оператора
    return 0;         // return - оператор за връщане (виж [Синтаксис](#3-синтаксис)), 0 - стойност за връщане, ; - край на оператора
}                     // } - край на съставния оператор (виж [Съставен оператор](../03_Оператори.md#3-съставен-оператор))
```

### Терминология в примерите:

- **`#include <stdio.h>`** - препроцесорна директива, която включва стандартната библиотека за вход/изход (`stdio` = standard input/output). Позволява използването на функции като `printf()` и `scanf()`. За повече информация виж [Препроцесор и етапи на компилация](#4-препроцесор-и-етапи-на-компилация)
- **`printf()`** - функция за форматиран изход (print formatted), извежда текст и данни на екрана. **Идва от `#include <stdio.h>`** - препроцесорната директива включва стандартната библиотека за вход/изход. За повече информация виж [Въвеждане и извеждане](../02_Целочислени%20типове%20данни.md#5-въвеждане-и-извеждане-на-данни-от-целочислен-тип)
- **`scanf()`** - функция за форматиран вход (scan formatted), чете данни от стандартния вход. **Идва от `#include <stdio.h>`** - препроцесорната директива включва стандартната библиотека за вход/изход. За повече информация виж [Въвеждане и извеждане](../02_Целочислени%20типове%20данни.md#5-въвеждане-и-извеждане-на-данни-от-целочислен-тип)
- **`return`** - оператор за връщане от функция. При `void` функции може да се използва `return;` или да се пропусне. При функции, които връщат стойност, след `return` трябва да има стойност (напр. `return 0;`). За повече информация виж [Синтаксис](#3-синтаксис)

## 4. Препроцесор и етапи на компилация

### Какво е препроцесор?

**Препроцесорът** е първият етап при обработката на C програма преди компилацията. Той обработва **препроцесорните директиви** - команди, които започват с `#` (диез).

### Какво прави препроцесорът?

Препроцесорът извършва следните операции:

1. **Включване на файлове** (`#include`)
   - Заменя `#include <stdio.h>` с цялото съдържание на файла `stdio.h`
   - Това позволява използването на функции от стандартните библиотеки

2. **Дефиниране на макроси** (`#define`)
   - Заменя дефинирани символи с техните стойности
   - Пример: `#define PI 3.14` - всяко срещане на `PI` се заменя с `3.14`

3. **Условна компилация** (`#ifdef`, `#ifndef`, `#endif`)
   - Позволява включване/изключване на части от кода в зависимост от условия

4. **Премахване на коментари**
   - Премахва коментарите от кода преди компилацията

### Етапите на компилация на C програма

Преобразуването на C програма в изпълним файл се извършва в няколко етапа:

#### **Етап 1: Препроцесиране (Preprocessing)**

**Вход:** Файл с разширение `.c` (напр. `program.c`)  
**Изход:** Препроцесиран файл (обикновено с разширение `.i`)

**Какво се случва:**
- Препроцесорът обработва всички директиви, започващи с `#`
- Заменя `#include` директивите с съдържанието на включените файлове
- Обработва макросите и условната компилация
- Премахва коментарите

**Пример:**
```c
// program.c
#include <stdio.h>
int main() {
    printf("Hello");
    return 0;
}
```

След препроцесиране, `#include <stdio.h>` се заменя с хиляди редове код от стандартната библиотека.

#### **Етап 2: Компилация (Compilation)**

**Вход:** Препроцесиран файл (`.i`)  
**Изход:** Файл с асемблерен код (обикновено с разширение `.s`)

**Какво се случва:**
- Компилаторът преобразува C код в асемблерен код (ниско ниво, специфичен за процесора)
- Проверява синтаксиса и семантиката на кода
- Генерира обектен код

#### **Етап 3: Асемблиране (Assembly)**

**Вход:** Асемблерен файл (`.s`)  
**Изход:** Обектен файл (обикновено с разширение `.o` или `.obj`)

**Какво се случва:**
- Асемблерът преобразува асемблерния код в машинен код (бинарни инструкции)
- Създава обектен файл, който все още не е изпълним

#### **Етап 4: Свързване (Linking)**

**Вход:** Обектни файлове (`.o`) и библиотеки  
**Изход:** Изпълним файл (напр. `program.exe` или `program`)

**Какво се случва:**
- Линкерът свързва обектните файлове с библиотеките
- Разрешава препратките между различни файлове
- Създава финалния изпълним файл

### Визуализация на процеса:

```
program.c  ──[Препроцесиране]──>  program.i  ──[Компилация]──>  program.s
                                                                      │
program.exe  <──[Свързване]──  program.o  <──[Асемблиране]───────────┘
```

### Важни бележки:

- **Препроцесорът работи преди компилацията** - той подготвя кода за компилатора
- **Препроцесорните директиви не са C код** - те са инструкции за препроцесора
- **Всички директиви започват с `#`** - това е знакът, който идентифицира препроцесорни команди
- **Препроцесорът не разбира C синтаксис** - той просто прави текстови замени

### Примери за препроцесорни директиви:

```c
#include <stdio.h>    // Включва стандартната библиотека за вход/изход
#include "myfile.h"   // Включва локален файл
#define MAX 100       // Дефинира макрос MAX със стойност 100
#define PI 3.14159    // Дефинира макрос PI
```

### Защо е важно да знаем това?

Разбирането на етапите на компилация помага:
- Да разберем защо трябва да включваме библиотеки с `#include`
- Да разберем грешките по време на компилация
- Да разберем разликата между грешки на компилация и грешки по време на изпълнение
- Да използваме правилно препроцесорните директиви
